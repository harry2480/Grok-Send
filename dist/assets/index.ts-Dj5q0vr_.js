(function(){const d=()=>{const t=document.querySelector('[data-testid="sendButton"]');if(t)return t;const e=document.querySelector('button[aria-label*="Send" i], button[aria-label*="送信" i], button[aria-label="Grok send"]');if(e)return e;const c=document.querySelector('button[data-testid="grok_send_button"]');if(c)return c;const i=document.querySelectorAll("button");for(let n=0;n<i.length;n++){const r=i[n];if(r.innerText.includes("Send")||r.innerText.includes("送信")||r.querySelector("svg"))return r}return null},f=t=>{const e=t.composedPath()[0];if(!e)return;const c=e.isContentEditable||e.getAttribute("contenteditable")==="true"||e.closest('[contenteditable="true"]')!==null,i=e.tagName==="TEXTAREA"||e.tagName==="INPUT";if(!c&&!i||t.isComposing||t.keyCode===229)return;const n=t.ctrlKey||t.metaKey;if(t.key==="Enter"){if(console.log("[Grok-Fix] Enter detected. Modifier:",n,"Shift:",t.shiftKey),n){t.stopImmediatePropagation(),t.preventDefault();const s=d();console.log("[Grok-Fix] Attempting to click send button:",s),s&&s.click();return}if(!n&&!t.shiftKey&&(t.stopImmediatePropagation(),t.preventDefault(),console.log("[Grok-Fix] Preventing default Enter, inserting newline"),!document.execCommand("insertText",!1,`
`)&&i)){const o=e,u=o.selectionStart||0,l=o.selectionEnd||0,a=o.value;o.value=a.substring(0,u)+`
`+a.substring(l),o.selectionStart=o.selectionEnd=u+1,o.dispatchEvent(new Event("input",{bubbles:!0}))}}};window.addEventListener("keydown",f,{capture:!0});window.addEventListener("keypress",t=>{t.key==="Enter"&&!t.shiftKey&&!t.ctrlKey&&!t.metaKey&&(t.stopImmediatePropagation(),t.preventDefault())},{capture:!0});console.log("[Grok-Fix] Extension loaded and intercepting Enter key.");
})()
